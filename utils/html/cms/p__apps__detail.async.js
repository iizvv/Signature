(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{2:function(e,t){},3:function(e,t){},A5co:function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"c",function(){return i}),a.d(t,"k",function(){return l}),a.d(t,"g",function(){return r}),a.d(t,"f",function(){return o}),a.d(t,"e",function(){return c}),a.d(t,"j",function(){return d}),a.d(t,"i",function(){return m}),a.d(t,"b",function(){return u}),a.d(t,"d",function(){return h}),a.d(t,"h",function(){return p});var n=a("t3Un");function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(n["a"])({url:"package/getAllPackage",method:"GET",params:{userId:e}})}function i(e){return Object(n["a"])({url:"package/getPackageById",method:"GET",params:{id:e}})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{console.log(e.loaded/e.total)};return Object(n["a"])({url:"package/insertPackage",method:"POST",headers:{"Content-Type":"multipart/form-data"},data:e,timeout:36e5,onUploadProgress:t})}function r(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>{console.log(e.loaded/e.total)};return Object(n["a"])({url:"package/updatePackageById",method:"POST",headers:{"Content-Type":"multipart/form-data"},params:{id:e},data:t,timeout:36e5,onUploadProgress:a})}function o(e,t){return Object(n["a"])({url:"package/updatePackageTotalDeviceById",method:"POST",data:{id:e,count:t}})}function c(e){return Object(n["a"])({url:"package/deletePackageById",method:"POST",data:{id:e}})}function d(e,t){return Object(n["a"])({url:"package/updatePackageSummaryById",method:"POST",data:{id:e,summary:t}})}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(n["a"])({url:"package/updatePackageImgsById",method:"POST",data:{id:e,imgs:t.join(",")}})}function u(e){return Object(n["a"])({url:"package/getAllUnusedKeysById",method:"GET",params:{id:e}})}function h(e,t,a){return Object(n["a"])({url:"package/insertPackageKeysById",method:"POST",params:{id:e,count:t,bit:a}})}function p(e,t){return Object(n["a"])({url:"package/updatePackageStateById",method:"POST",params:{id:e,state:t}})}},KLoe:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return A});a("Znn+");var n=a("ZTPi"),s=(a("Mwp2"),a("VXEj")),i=(a("MXD1"),a("CFYs")),l=a("jehZ"),r=a.n(l),o=(a("miYZ"),a("tsqr")),c=(a("5NDa"),a("5rEg")),d=(a("fOrg"),a("+KLJ")),m=(a("DZo9"),a("8z0m")),u=a("d6i3"),h=a.n(u),p=a("1l/V"),g=a.n(p),f=(a("2qtc"),a("kLXV")),b=(a("giR+"),a("fyUT")),v=(a("P2fV"),a("NJEC")),y=(a("/xke"),a("TeRw")),E=(a("Pwec"),a("CtXQ")),k=(a("5Dmo"),a("3S7+")),x=(a("BoS7"),a("Sdc0")),C=(a("+L6B"),a("2/Rp")),S=(a("IzEo"),a("bx4M")),w=(a("Telt"),a("Tckk")),I=(a("bP8k"),a("gFTJ")),L=a("p0pE"),O=a.n(L),T=a("q1tI"),D=a.n(T),P=a("A5co"),j=a("D1Df"),M=a.n(j),V=a("3a4m"),N=a.n(V),B=a("7tlc"),U=a("FcY/"),q=a.n(U);class A extends D.a.Component{constructor(){super(),this.state={buildVersion:"",bundleIdentifier:"",useDevice:0,totalDevice:0,icon:"",id:0,link:"",miniVersion:"",mobileconfig:"",name:"",summary:"",version:"",imgs:"",stint:!1,stintLoading:!1,qrcodeData:null,maxCountModal:!1,maxCountModalLoading:!1,resetCountModalLoading:!1,inputMaxCount:1,deleteing:!1,updateingSummary:!1,updateAppModalVisible:!1,InvitationCodeModal:!1}}componentDidMount(){this.loadData()}loadData(){var e=this.props.location.query;Object(P["c"])(e.id).then(e=>{var t=e.data;this.setState(O()({},this.state,t.data));var a=document.getElementById("qrcode");this.setState({qrcodeData:a.toDataURL("image/png")})}).catch(e=>{console.log(e)})}getClientDetailURL(){return this.state.link}render(){return 0===this.state.id?null:D.a.createElement("div",null,D.a.createElement(I["a"],{bordered:!0,column:{xxl:2,xl:2,lg:2,md:2,sm:1,xs:1},style:{background:"#fff"},title:D.a.createElement("div",{className:"ant-card-head-wrapper"},D.a.createElement("div",{className:"ant-card-head-title"},"\u57fa\u672c\u4fe1\u606f"))},D.a.createElement(I["a"].Item,{label:"\u5e94\u7528\u540d\u79f0:"},this.state.name),D.a.createElement(I["a"].Item,{label:"\u56fe\u6807:"},D.a.createElement(w["a"],{src:this.state.icon,shape:"square",size:"large"})),D.a.createElement(I["a"].Item,{label:"\u5e94\u7528\u7248\u672c:"},this.state.version),D.a.createElement(I["a"].Item,{label:"Build \u7248\u672c:"},this.state.buildVersion),D.a.createElement(I["a"].Item,{label:"\u5e94\u7528ID:"},this.state.bundleIdentifier),D.a.createElement(I["a"].Item,{label:"\u7cfb\u7edf\u7248\u672c:"},this.state.miniVersion),D.a.createElement(I["a"].Item,{label:"\u5e94\u7528\u63cf\u8ff0:"},D.a.createElement(z,{id:this.state.id,value:this.state.summary}))),D.a.createElement(S["a"],{bordered:!1,style:{background:"#fff",marginTop:"30px"},title:D.a.createElement("div",{style:{display:"flex",alignItems:"center"}},D.a.createElement("div",null,"\u9884\u89c8\u56fe"))},D.a.createElement(R,{id:this.state.id,imgs:this.state.imgs})),D.a.createElement(I["a"],{bordered:!0,column:{xxl:2,xl:2,lg:2,md:2,sm:1,xs:1},style:{background:"#fff",marginTop:"30px"},title:D.a.createElement("div",{className:"ant-card-head-wrapper"},D.a.createElement("div",{className:"ant-card-head-title"},"\u5b89\u88c5\u9650\u5236"))},D.a.createElement(I["a"].Item,{label:"\u4e0b\u8f7d\u8bbe\u5907\u6570\u91cf:"},this.state.useDevice,"\u6b21"),D.a.createElement(I["a"].Item,{label:"\u4e0b\u8f7d\u8bbe\u5907\u9650\u5236:"},D.a.createElement("span",null,this.state.totalDevice,"\u6b21"),D.a.createElement(C["a"],{defaultValue:this.state.stint,style:{marginLeft:"10px"},size:"small",onClick:e=>this.setState({maxCountModal:!0})},"\u4fee\u6539")),D.a.createElement(I["a"].Item,{label:"\u4f7f\u7528\u9080\u8bf7\u7801:"},D.a.createElement(k["a"],{title:"\u542f\u7528\u540e\uff0c\u4e0b\u8f7d\u5fc5\u987b\u4f7f\u7528\u9080\u8bf7\u7801\u3002"},D.a.createElement(x["a"],{checked:this.state.stint,loading:this.state.stintLoading,onChange:e=>{this.setState({stintLoading:!0}),Object(P["h"])(this.state.id,e).then(t=>{var a=t.data;this.setState({stintLoading:!1}),1===a.code&&this.setState({stint:e})}).catch(e=>{this.setState({stintLoading:!1})})}}))),D.a.createElement(I["a"].Item,{label:"\u67e5\u770b\u9080\u8bf7\u7801:"},D.a.createElement(C["a"],{style:{marginLeft:"10px"},size:"small",onClick:e=>this.setState({InvitationCodeModal:!0})},"\u67e5\u770b"))),D.a.createElement(I["a"],{bordered:!0,column:{xxl:2,xl:2,lg:2,md:2,sm:1,xs:1},style:{background:"#fff",marginTop:"30px"},title:D.a.createElement("div",{className:"ant-card-head-wrapper"},D.a.createElement("div",{className:"ant-card-head-title"},"\u8f6f\u4ef6\u7ba1\u7406"))},D.a.createElement(I["a"].Item,{label:"\u5b89\u88c5\u5730\u5740:"},D.a.createElement("a",{href:this.getClientDetailURL(),target:"_blank",rel:"noopener noreferrer"},"\u6253\u5f00")),D.a.createElement(I["a"].Item,{label:"\u4e8c\u7ef4\u7801:"},D.a.createElement(M.a,{style:{display:"none"},id:"qrcode",size:256,value:this.getClientDetailURL()}),D.a.createElement("img",{style:{width:"100px"},src:this.state.qrcodeData,alt:""})),D.a.createElement(I["a"].Item,{label:"\u66f4\u65b0:"},D.a.createElement(C["a"],{type:"primary",onClick:()=>{this.setState({updateAppModalVisible:!0})}},D.a.createElement(E["a"],{type:"upload"}),"\u66f4\u65b0\u8f6f\u4ef6")),D.a.createElement(I["a"].Item,{label:"\u5220\u9664:"},D.a.createElement(v["a"],{title:"\u786e\u5b9a\u5220\u9664\u8be5\u8f6f\u4ef6\uff1f",icon:D.a.createElement(E["a"],{type:"question-circle-o",style:{color:"red"}}),okText:"\u5220\u9664",cancelText:"\u53d6\u6d88",onConfirm:e=>{this.setState({deleteing:!0}),Object(P["e"])(this.state.id).then(e=>{this.setState({deleteing:!1}),y["a"].info({message:'\u5df2\u5220\u9664 "'.concat(this.state.name,'"')}),N.a.push("/apps")}).catch(e=>{this.setState({deleteing:!1})})}},D.a.createElement(C["a"],{type:"danger",loading:this.state.deleteing},D.a.createElement(E["a"],{type:"delete"}),"\u5220\u9664\u8f6f\u4ef6")))),D.a.createElement(f["a"],{title:"\u8bbe\u7f6e\u6700\u5927\u4e0b\u8f7d\u8bbe\u5907\u6570\u91cf",visible:this.state.maxCountModal,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:e=>{this.setState({maxCountModalLoading:!0}),Object(P["f"])(this.state.id,this.state.inputMaxCount).then(e=>{var t=e.data;console.log(t),this.setState({maxCountModalLoading:!1,maxCountModal:!1,totalDevice:this.state.inputMaxCount})}).catch(e=>{this.setState({maxCountModalLoading:!1})})},confirmLoading:this.state.maxCountModalLoading,onCancel:e=>this.setState({maxCountModal:!1})},D.a.createElement(b["a"],{defaultValue:this.state.totalDevice,min:0,step:1,formatter:e=>parseInt(e)||0,onChange:e=>this.setState({inputMaxCount:e||0}),disabled:this.state.maxCountModalLoading,style:{display:"block",width:"100%"}})),D.a.createElement(K,{id:this.state.id,visible:this.state.updateAppModalVisible,onCancel:()=>{this.setState({updateAppModalVisible:!1})},uploadCallback:()=>{this.loadData()}}),D.a.createElement(J,{id:this.state.id,visible:this.state.InvitationCodeModal,onCancel:e=>this.setState({InvitationCodeModal:!1})}))}}function F(e){return new Promise((t,a)=>{var n=new FileReader;n.readAsDataURL(e),n.onload=(()=>t(n.result)),n.onerror=(e=>a(e))})}class R extends D.a.Component{constructor(){var e;super(...arguments),e=this,this.state={previewVisible:!1,previewImage:"",fileList:[],changeFlag:!1},this.handleCancel=(()=>this.setState({previewVisible:!1})),this.handlePreview=function(){var t=g()(h.a.mark(function t(a){return h.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(a.url||a.preview){t.next=4;break}return t.next=3,F(a.originFileObj);case 3:a.preview=t.sent;case 4:e.setState({previewImage:a.url||a.preview,previewVisible:!0});case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),this.handleChange=(e=>{var t=e.fileList;this.setState({fileList:t,changeFlag:!0})})}componentDidMount(){var e=this.props.imgs;if(!1===Object(B["isNullOrUndefined"])(e)){var t=this.props.imgs.split(",").map((e,t)=>{return{uid:t,name:"image",status:"done",url:e}});this.setState({fileList:t})}}render(){var e=this.props.id,t=this.state,a=t.previewVisible,n=t.previewImage,s=t.fileList;if(0===e)return null;var i=D.a.createElement("div",null,D.a.createElement(E["a"],{type:"plus"}),D.a.createElement("div",{className:"ant-upload-text"},"\u4e0a\u4f20")),l=window.g_app._store.getState().user.token;return D.a.createElement("div",{className:"clearfix"},D.a.createElement(m["a"],{multiple:!0,headers:{Authorization:l},action:"".concat(window.ENV_BASEAPI,"file/uploadImage"),listType:"picture-card",fileList:s,onPreview:this.handlePreview,onChange:this.handleChange},i),D.a.createElement(f["a"],{visible:a,footer:null,onCancel:this.handleCancel},D.a.createElement("img",{alt:"example",style:{width:"100%"},src:n})),this.state.changeFlag&&D.a.createElement(C["a"],{block:!0,type:"primary",onClick:()=>{var t=t=>{var a=s.filter(e=>"done"===e.status).map(e=>e.url||e.response.data);Object(P["i"])(e,a).then(e=>{this.setState({changeFlag:!1})}).catch(e=>{})};s.filter(e=>"done"!==e.status).length>0?f["a"].confirm({title:"\u8fd8\u6709\u672a\u5b8c\u6210\u7684\u6587\u4ef6",content:"\u4e0a\u4f20\u4e2d\u548c\u5931\u8d25\u7684\u56fe\u7247\u5c06\u88ab\u4e22\u5f03\u3002",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk(){t()}}):t()}},"\u4fdd\u5b58"))}}class z extends D.a.Component{constructor(){super(...arguments),this.state={status:0,summary:null},this.hanldeSummary=(e=>{this.setState({summary:e.target.value,status:-1})})}render(){var e=this.props,t=e.id,a=e.value,n=D.a.createElement(C["a"],{block:!0,type:"primary",style:{marginTop:"10px"},loading:1===this.state.status,onClick:e=>{this.setState({status:1}),Object(P["j"])(t,this.state.summary).then(()=>{this.setState({status:2})}).catch(()=>{this.setState({status:3})})}},"\u4fdd\u5b58");return D.a.createElement(D.a.Fragment,null,3===this.state.status&&D.a.createElement(d["a"],{message:"\u4fdd\u5b58\u5931\u8d25",type:"error",showIcon:!0,style:{marginBottom:"10px"}}),D.a.createElement(c["a"].TextArea,{autosize:{minRows:6,maxRows:12},onChange:this.hanldeSummary,value:this.state.summary||a}),0!==this.state.status&&2!==this.state.status&&n)}}class K extends D.a.Component{constructor(){super(...arguments),this.state={fileList:[],uploading:!1,uploadProgress:0,appDisplayName:"",icon:""},this.handleUpload=(()=>{var e=this.state.fileList,t=new FormData;t.append("file",e[0]),this.setState({uploading:!0}),this.setState({uploadProgress:0}),Object(P["g"])(this.props.id,t,e=>{var t=e.loaded/e.total*100|0;this.setState({uploadProgress:t}),console.log(t)}).then(e=>{var t=e.data;console.log(t),this.setState({fileList:[],uploading:!1}),y["a"].success({message:"\u66f4\u65b0\u6210\u529f"}),this.props.uploadCallback(),this.props.onCancel(),this.setState({uploadProgress:0})}).catch(e=>{console.log(e),this.setState({uploading:!1}),y["a"].error({message:"\u4e0a\u4f20\u5931\u8d25",duration:null})})})}render(){var e=this.props,t=e.visible,a=e.onCancel,n=this.state,s=n.uploading,l=n.fileList,c=n.appDisplayName,d=n.icon,u={onRemove:e=>{this.setState(t=>{var a=t.fileList.indexOf(e),n=t.fileList.slice();return n.splice(a,1),{fileList:n}})},beforeUpload:e=>{var t=e.name.endsWith(".ipa");if(!t)return o["a"].error("\u8bf7\u9009\u62e9 ipa \u6587\u4ef6!"),this.setState(e=>({fileList:[]})),!1;var a=new q.a(e);return a.parse().then(t=>{console.log("app info ----\x3e ",t),this.setState(a=>({fileList:[e],appDisplayName:"".concat(t.CFBundleDisplayName,"(").concat(t.CFBundleShortVersionString,")"),icon:t.icon}))}).catch(e=>{o["a"].error(e),console.log("err ----\x3e ",e)}),!1},fileList:l};return D.a.createElement(f["a"],{title:"\u66f4\u65b0\u8f6f\u4ef6",visible:t,footer:null,onCancel:a},D.a.createElement(m["a"].Dragger,r()({},u,{style:{display:"flex",width:"100%",justifyContent:"center",alignItems:"center"}}),D.a.createElement("p",{className:"ant-upload-drag-icon"},D.a.createElement(E["a"],{type:"upload"})),D.a.createElement("p",null,"\u70b9\u51fb\u6216\u62d6\u62fd\u9009\u62e9 ipa \u6587\u4ef6")),l.length>0&&D.a.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:"10px"}},D.a.createElement(w["a"],{shape:"square",size:50,icon:"question",src:d}),D.a.createElement("div",{style:{marginLeft:"10px"}},c)),D.a.createElement(C["a"],{type:"primary",onClick:this.handleUpload,disabled:0===l.length,loading:s,style:{marginTop:16},block:!0,size:"large"},s?"\u4e0a\u4f20\u4e2d...":"\u4e0a\u4f20"),this.state.uploadProgress>0&&D.a.createElement(i["a"],{percent:this.state.uploadProgress,status:"active"}))}}class J extends D.a.Component{constructor(){super(...arguments),this.state={count:1,digit:6,loading:!1,unusedKeys:[],usedKeys:[]}}componentDidMount(){this.loadData()}loadData(){var e=this.props.id;this.setState({loading:!0}),Object(P["b"])(e).then(e=>{var t=e.data;this.setState({unusedKeys:t.data,loading:!1})}).catch(e=>{this.setState({usedKeys:[],unusedKeys:[],loading:!1})})}commit(){var e=this.props.id,t=this.state,a=t.count,n=t.digit;Object(P["d"])(e,a,n).then(e=>{var t=e.data;y["a"].success({message:"".concat(t.msg)}),this.loadData()}).catch(e=>{console.log(e)})}render(){var e=this.props,t=e.visible,a=e.onCancel;return D.a.createElement(f["a"],{visible:t,footer:null,onCancel:a,centered:!0,keyboard:!1,maskClosable:!1,width:"70vw",bodyStyle:{height:"80vh"}},D.a.createElement(n["a"],{style:{background:"#fff",height:"100%"},tabBarExtraContent:D.a.createElement(C["a"],{icon:"sync",style:{marginRight:"16px"},loading:this.state.loading,onClick:()=>{this.loadData()}},"\u5237\u65b0")},D.a.createElement(n["a"].TabPane,{tab:"\u9080\u8bf7\u7801\u5217\u8868",key:"0",style:{height:"calc(100% - 60px)",overflow:"scroll"}},D.a.createElement(s["a"],{loading:this.state.loading,dataSource:this.state.unusedKeys,renderItem:e=>D.a.createElement(s["a"].Item,null,e.key)})),D.a.createElement(n["a"].TabPane,{tab:"\u521b\u5efa\u65b0\u7684\u9080\u8bf7\u7801",key:"2"},D.a.createElement("h4",null,"\u521b\u5efa\u6570\u91cf:"),D.a.createElement(b["a"],{defaultValue:this.state.count,min:1,step:1,onChange:e=>this.setState({count:e}),style:{display:"block",width:"100%"}}),D.a.createElement("h4",{style:{marginTop:"10px"}},"\u9080\u8bf7\u7801\u4f4d\u6570:"),D.a.createElement(b["a"],{defaultValue:this.state.digit,min:1,step:1,onChange:e=>this.setState({digit:e}),style:{display:"block",width:"100%"}}),D.a.createElement(C["a"],{block:!0,type:"primary",disabled:Object(B["isNullOrUndefined"])(this.state.count)||Object(B["isNullOrUndefined"])(this.state.digit),style:{marginTop:"10px"},onClick:()=>{this.commit()}},"\u521b\u5efa"))))}}}}]);